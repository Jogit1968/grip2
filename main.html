<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GRIP2</title>
    <link rel="manifest" href="manifest.json">

    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }

        .slider-container {
            margin-bottom: 25px;
        }

        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        input[type="range"] {
            width: 100%;
        }

        .value {
            font-size: 1.1em;
            color: #333;
        }

        .button-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        button {
            flex: 1;
            padding: 12px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 6px;
            border: none;
            background: #ddd;
        }

        button:hover {
            background: #ccc;
        }

        #status {
            margin-top: 20px;
            padding: 12px;
            background: #c8f7c5;
            color: #2d7a2d;
            border: 1px solid #8fd88f;
            border-radius: 5px;
            display: none;
            text-align: center;
        }

        #timestamps {
            margin-top: 20px;
            font-size: 0.9em;
            color: #444;
        }

        @media (max-width: 480px) {
            .button-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

    <h2>GRIP2-Werte</h2>

    <div class="slider-container">
        <label for="HSC">HSC</label>
        <input type="range" id="HSC" min="0" max="8" value="0">
        <span class="value" id="val_HSC">0</span>
    </div>

    <div class="slider-container">
        <label for="LSC">LSC</label>
        <input type="range" id="LSC" min="0" max="14" value="0">
        <span class="value" id="val_LSC">0</span>
    </div>

    <div class="slider-container">
        <label for="HSR">HSR</label>
        <input type="range" id="HSR" min="0" max="8" value="0">
        <span class="value" id="val_HSR">0</span>
    </div>

    <div class="slider-container">
        <label for="LSR">LSR</label>
        <input type="range" id="LSR" min="0" max="17" value="0">
        <span class="value" id="val_LSR">0</span>
    </div>

    <button id="saveBtn">Speichern</button>

    <h3>Gespeicherte Sets</h3>
    <div class="button-row">
        <button class="loadBtn" data-index="0">Set 1</button>
        <button class="loadBtn" data-index="1">Set 2</button>
        <button class="loadBtn" data-index="2">Set 3</button>
        <button class="loadBtn" data-index="3">Set 4</button>
        <button class="loadBtn" data-index="4">Set 5</button>
    </div>

    <div id="timestamps"></div>

    <div id="status">Gespeichert!</div>

    <script>
        const sliders = ["HSC", "LSC", "HSR", "LSR"];

        function showStatus(msg) {
            const box = document.getElementById("status");
            box.textContent = msg;
            box.style.display = "block";
            setTimeout(() => box.style.display = "none", 2000);
        }

        function updateDisplayedValues() {
            sliders.forEach(id => {
                document.getElementById("val_" + id).textContent =
                    document.getElementById(id).value;
            });
        }

        sliders.forEach(id => {
            document.getElementById(id).addEventListener("input", updateDisplayedValues);
        });

        function loadSets() {
            const json = localStorage.getItem("valueSets");
            return json ? JSON.parse(json) : [];
        }

        function saveSets(sets) {
            localStorage.setItem("valueSets", JSON.stringify(sets));
        }

        function saveNewSet() {
            const sets = loadSets();

            const newSet = {
                values: {},
                timestamp: new Date().toLocaleString()
            };

            sliders.forEach(id => {
                newSet.values[id] = document.getElementById(id).value;
            });

            sets.push(newSet);

            if (sets.length > 5) {
                sets.shift(); // ältestes löschen
            }

            saveSets(sets);
            updateTimestamps();
            showStatus("Neues Set gespeichert");
        }

        function loadSet(index) {
            const sets = loadSets();
            if (!sets[index]) {
                showStatus("Kein Set gespeichert");
                return;
            }

            const set = sets[index].values;

            sliders.forEach(id => {
                document.getElementById(id).value = set[id];
                document.getElementById("val_" + id).textContent = set[id];
            });

            showStatus("Set " + (index + 1) + " geladen");
        }

        function updateTimestamps() {
            const sets = loadSets();
            const box = document.getElementById("timestamps");

            if (sets.length === 0) {
                box.innerHTML = "<p>Noch keine Sets gespeichert</p>";
                return;
            }

            let html = "<h4>Gespeichert am:</h4>";
            sets.forEach((set, i) => {
                html += `<p>Set ${i + 1}: ${set.timestamp}</p>`;
            });

            box.innerHTML = html;
        }

        document.getElementById("saveBtn").addEventListener("click", saveNewSet);

        document.querySelectorAll(".loadBtn").forEach(btn => {
            btn.addEventListener("click", () => {
                loadSet(btn.dataset.index);
            });
        });

        updateTimestamps();


        if ("serviceWorker" in navigator) { 
            navigator.serviceWorker.register("service-worker.js");
    }
    </script>

</body>
</html>
